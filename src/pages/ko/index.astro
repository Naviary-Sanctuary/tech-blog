---
import { getCollection } from "astro:content";
import Divider from "../../components/Divider.astro";
import Link from "../../components/Link.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

const posts = (await getCollection("blog"))
  .sort(
    (a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf(),
  )
  .slice(0, 3);
---

<BaseLayout description="나비어리의 기술은 기록에서 시작됩니다.">
  <main class="max-w-4xl mx-auto py-12 md:py-20 px-4 sm:px-6">
    <!-- Hero Section -->
    <section class="mb-20 relative">
      <div class="flex flex-col items-center justify-center text-center">
        <h1
          class="text-3xl sm:text-4xl md:text-5xl font-extrabold tracking-tight leading-[1.15] break-keep"
        >
          나비어리의 기술은
          <br class="sm:hidden" />
          <span class="relative inline-block mx-1">
            <span
              class="absolute left-0 bottom-1 w-full h-[10px] bg-primary/40 rounded-sm"
            ></span>
            <span class="relative z-10">기록</span>
          </span>에서 시작됩니다.
        </h1>
        <div
          class="mt-10 max-w-xl space-y-5 text-zinc-600 text-[15px] sm:text-lg leading-8 break-keep"
        >
          <p>기록은 좌표가 되고, 좌표는 방향이 됩니다.</p>
          <p>
            우리는 개체와 번식의 흐름을 구조화하고,
            <br class="hidden sm:block" />
            브리딩을 설계 가능한 시스템으로 전환합니다.
          </p>
          <p>이곳은 그 과정을 기록하는 기술 아카이브입니다.</p>
        </div>
      </div>
    </section>

    <!-- Articles Section -->
    <section>
      <!-- Article header -->
      <div class="mb-3 flex items-end justify-between">
        <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold tracking-tight">
          Articles
        </h2>
        <Link
          href="/articles"
          class="group inline-flex items-center text-sm font-medium text-zinc-600 hover:text-zinc-900 transition-colors"
        >
          <span
            class="relative after:absolute after:left-0 after:-bottom-0.5 after:h-px after:w-0 after:bg-primary after:transition-all after:duration-200 group-hover:after:w-full"
          >
            더보기
          </span>
        </Link>
      </div>
      <Divider />
      <!-- Articles -->
      <div class="flex flex-col gap-16 mt-10">
        {
          posts.map((post) => {
            return (
              <Link
                href={`/articles/${post.id}`}
                class="group block rounded-xl -mx-3 px-3 py-4 transition-all duration-200 hover:bg-tertiary/2 hover:shadow-[0_1px_0_rgba(0,0,0,0.04)] focus-visible:outline focus-visible:outline-offset-2 focus-visible:outline-primary/60 active:scale-[0.998]"
                aria-label={`${post.data.title} 글 읽기`}
              >
                <article class="flex flex-col gap-3 sm:flex-row sm:gap-10">
                  <time
                    datetime={post.data.date}
                    class="shrink-0 pt-1 w-fit whitespace-nowrap text-xs sm:text-sm tracking-wide text-zinc-400"
                  >
                    {post.data.date}
                  </time>

                  <div class="flex flex-col gap-3">
                    <div class="inline-flex w-fit items-center rounded-[4px] border border-zinc-300/70 px-2 py-0.5 text-[11px] font-medium tracking-wide text-secondary">
                      {post.data.category}
                    </div>
                    <h3 class="text-xl font-bold leading-snug text-zinc-900">
                      {post.data.title}
                    </h3>
                    <p class="text-sm sm:text-[15px] leading-7 text-zinc-600">
                      {post.data.description}
                    </p>
                  </div>
                </article>
              </Link>
            );
          })
        }
      </div>
    </section>
  </main>
</BaseLayout>
